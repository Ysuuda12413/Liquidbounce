package net.ccbluex.liquidbounce.features.module.modules.exploit

import net.ccbluex.liquidbounce.event.PacketEvent
import net.ccbluex.liquidbounce.event.UpdateEvent
import net.ccbluex.liquidbounce.event.handler
import net.ccbluex.liquidbounce.features.module.Category
import net.ccbluex.liquidbounce.features.module.Module
import net.minecraft.network.Packet
import net.minecraft.network.play.client.*
import java.util.*

object IntaveDisabler : Module(
    name = "IntaveDisabler",
    category = Category.EXPLOIT,
) {
    private var lastScaffoldPlace = 0L
    private var lastAttackTime = 0L

    val onPacket = handler<PacketEvent> { event ->
        val packet = event.packet

        // ----------- KillAura Bypass -----------
        if (packet is C02PacketUseEntity && packet.action == C02PacketUseEntity.Action.ATTACK) {
            val delay = (55..120).random()
            if (System.currentTimeMillis() - lastAttackTime < delay) {
                event.cancelEvent()
                return@handler
            }
            lastAttackTime = System.currentTimeMillis()
        }
    }
    override val tag: String
        get() = "DuyunDz On Top"
}